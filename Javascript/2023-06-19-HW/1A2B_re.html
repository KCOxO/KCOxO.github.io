<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
</head>
<style>
    .guess-board {
        margin: auto;
        text-align: center;
    }

    .guess-board h1 {
        font-size: 30px;
        margin-bottom: 15px;
    }

    .guess-board .list-group {
        margin: 10px auto;
        width: 75%;
        height: 200px;
        border: 1px dotted black;
        text-align: left;
        overflow-y: auto;
    }
</style>

<body>
    <div class="guess-board">
        <h1>1A2B</h1>
        <div class="btn-group w-75 mt-3" role="group" aria-label="Basic example">
            <button id="start_btn" type="button" class="btn btn-outline-secondary">é–‹å§‹</button>
            <button id="restart_btn" type="button" class="btn btn-outline-secondary mx-3">æ”¾æ£„é‡ä¾†</button>
            <button id="peek_btn" type="button" class="btn btn-outline-secondary">çœ‹ç­”æ¡ˆ</button>
        </div>
        <div id="liveAlertPlaceholder" class="w-75 m-auto"></div>
        <div class="history mt-3">
            <ul id="ul" class="list-group">
            </ul>
            <div class="input-group my-3 mx-auto w-75">
                <span class="input-group-text">çŒœç­”æ¡ˆ</span>
                <input id="guess_input" type="text" class="form-control" placeholder="è«‹è¼¸å…¥å››å€‹ä¸é‡è¤‡æ•¸å­—" aria-label="Username"
                    aria-describedby="basic-addon1">
                <button id="guess_btn" type="button" class="btn btn-outline-secondary">çŒœ</button>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
        crossorigin="anonymous"></script>



    <script>
        const guessInput = document.getElementById('guess_input')
        const guessBtn = document.getElementById('guess_btn')
        const startBtn = document.getElementById('start_btn')
        const restartBtn = document.getElementById('restart_btn')
        const peekBtn = document.getElementById('peek_btn')
        const ulDom = document.getElementById('ul')
        // ç”¢ç”Ÿå››å€‹ä¸é‡è¤‡äº‚æ•¸


        let randomNum, guessNum;
        let ans = [];
        let guessInt = [];
        let emoji = 'ğŸ«£';
        let emoji1 = 'ğŸ‰ğŸ‰ğŸ‰';


        startBtn.addEventListener("click", function () {
            ulDom.innerHTML = '';
            ableBtn();
        });

        const alertPlaceholder = document.getElementById('liveAlertPlaceholder')
        const appendAlert = (message, type) => {
            const wrapper = document.createElement('div')
            wrapper.innerHTML = [
                `<div class="alert alert-${type} alert-dismissible" role="alert">`,
                `   <div>${message}</div>`,
                '   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',
                '</div>'
            ].join('')

            alertPlaceholder.append(wrapper)
        }

        restartBtn.addEventListener("click", function () {
            appendAlert('ç­”æ¡ˆæ˜¯' + emoji + ans.join(''), 'info')
            guessInput.value = '';
            ulDom.innerHTML = '';
            ans = [];
            disableBtn();
            numGenerator();
        });

        peekBtn.addEventListener("click", function () {
            appendAlert('ç­”æ¡ˆæ˜¯' + emoji + ans.join(''), 'info')
        });

        guessInput.addEventListener("keypress", function (event) {
            if (event.key === "Enter") {
                guess();
            }
        })

        guessBtn.addEventListener("click", guess);

        window.onload = function () {
            disableBtn();
            numGenerator();

        }

        function guess(event) {
            // åˆ¤æ–·æ˜¯å¦è¼¸å…¥å››å€‹æ•¸å­—
            const inputNum = guessInput.value.trim();
            // å°‡è¼¸å…¥å­—ä¸²è½‰æˆæ•¸å­—é™£åˆ—
            guessNum = inputNum.split('').map(Number);
            console.log(guessNum)
            if (inputNum === '' || isNaN(inputNum) || inputNum.length < 4 || inputNum.length > 4) {
                alert('è«‹è¼¸å…¥å››å€‹æ•¸å­—');
                guessInput.value = '';
                return;
            } else {
                let countA = 0, countB = 0;
                for (i = 0; i < guessNum.length; i++) {
                    if (guessNum[i] === guessNum[i + 1]) {
                        appendAlert('è«‹è¼¸å…¥å››å€‹ä¸é‡è¤‡æ•¸å­—', 'danger')
                        guessInput.value = '';
                        return;
                    } else if (guessNum[i] === ans[i]) {
                        countA++;
                    } else if (ans.includes(guessNum[i])) {
                        countB++;
                    }
                }
                if (countA === 4) {
                    ulDom.innerHTML += `<li class="list-group-item"><span class="badge bg-success rounded-pill">${countA}A${countB}B</span>${guessNum.join('')}</li>`
                    appendAlert('ç­”å°äº†' + emoji1, 'success')
                    disableBtn();
                    guessInput.value = '';
                } else {
                    ulDom.innerHTML += `<li class="list-group-item"><span class="badge bg-danger rounded-pill">${countA}A${countB}B</span>${guessNum.join('')}</li>`
                }
                guessInput.value = '';
            }
        };

        // ç”¢å‡ºå››å€‹ä¸é‡è¤‡ä¸”å°æ–¼10çš„æ•¸å­—
        function numGenerator() {
            while (ans.length < 4) {
                randomNum = Math.floor(Math.random() * 10);
                if (!ans.includes(randomNum)) {
                    ans.push(randomNum);
                };
            };
        };

        // é—œé–‰æŒ‰éˆ•
        function disableBtn() {
            guessBtn.disabled = true;
            restartBtn.disabled = true;
            peekBtn.disabled = true;
        };

        // æ‰“é–‹æŒ‰éˆ•
        function ableBtn() {
            guessBtn.disabled = false;
            restartBtn.disabled = false;
            peekBtn.disabled = false;
        };
    </script>
</body>

</html>