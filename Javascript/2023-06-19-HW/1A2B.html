<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../reset.css">
</head>
<style>
    .guess-board {
        margin: auto;
        text-align: center;
    }

    .guess-board h1 {
        font-size: 30px;
        margin-bottom: 15px;
    }

    .guess-board .record {
        margin: 10px auto;
        width: 300px;
        height: 200px;
        border: 1px dotted black;
        overflow-y: auto;
    }

    .guess-board .record p {
        padding-right: 10px;
    }
</style>

<body>
    <div class="guess-board">
        <h1>1A2B</h1>
        <div class="btn-group">
            <button id="start_btn">é–‹å§‹</button>
            <button id="restart_btn">æ”¾æ£„é‡ä¾†</button>
            <button id="peek_btn">çœ‹ç­”æ¡ˆ</button>
        </div>
        <div class="record">
            <p></p>
        </div>
        <div class="input">
            <label for="guess_input">
                <input type="text" id="guess_input">
                <button id="guess_btn">çŒœï¼</button>
            </label>
        </div>
    </div>


</body>

<script>
    const guessInput = document.getElementById('guess_input')
    const guessBtn = document.getElementById('guess_btn')
    const startBtn = document.getElementById('start_btn')
    const restartBtn = document.getElementById('restart_btn')
    const peekBtn = document.getElementById('peek_btn')
    const recordp = document.querySelector('p')
    // ç”¢ç”Ÿå››å€‹ä¸é‡è¤‡äº‚æ•¸


    let randomNum, guessNum;
    let ans = [];
    let guessInt = [];
    let emoji = 'ğŸ«£';
    let emoji1 = 'ğŸ‰ğŸ‰ğŸ‰';


    startBtn.addEventListener("click", function () {
        ableBtn();
    });

    restartBtn.addEventListener("click", function () {
        alert(`ç­”æ¡ˆæ˜¯ ${emoji} ${ans.join('')}`);
        guessInput.value = '';
        recordp.innerHTML = '';
        ans = [];
        disableBtn();
        numGenerator();
    });

    peekBtn.addEventListener("click", function () {
        alert(`ç­”æ¡ˆæ˜¯ ${emoji} ${ans.join('')}`);
    });

    guessBtn.addEventListener("click", guess);

    window.onload = function () {
        disableBtn();
        numGenerator();

    }

    function guess(event) {
        // åˆ¤æ–·æ˜¯å¦è¼¸å…¥å››å€‹æ•¸å­—
        const inputNum = guessInput.value.trim();
        // å°‡è¼¸å…¥å­—ä¸²è½‰æˆæ•¸å­—é™£åˆ—
        guessNum = inputNum.split('').map(Number);
        if (inputNum === '' || isNaN(inputNum) || inputNum.length < 4 || inputNum.length > 4) {
            alert('è«‹è¼¸å…¥å››å€‹æ•¸å­—');
            guessInput.value = '';
            return;
        } else {
            let countA = 0, countB = 0;
            for (i = 0; i < guessNum.length; i++) {
                if (guessNum[i] === guessNum[i + 1]) {
                    alert('è«‹è¼¸å…¥ä¸é‡è¤‡çš„å››å€‹æ•¸å­—')
                    guessInput.value = '';
                    return;
                } else if (guessNum[i] === ans[i]) {
                    countA++;
                } else if (ans.includes(guessNum[i])) {
                    countB++;
                }
            }
            if (countA === 4) {
                recordp.innerHTML += `${guessNum.join('')}ã€€${countA}A`
                alert(`æ­å–œç­”å°${emoji1}`);
                guessInput.value = '';
                recordp.innerHTML = '';
                disableBtn();
            } else {
                recordp.innerHTML += `${guessNum.join('')}ã€€${countA}A${countB}B<br>`
            }
            guessInput.value = '';
        }
    };

    // ç”¢å‡ºå››å€‹ä¸é‡è¤‡ä¸”å°æ–¼10çš„æ•¸å­—
    function numGenerator() {
        while (ans.length < 4) {
            randomNum = Math.floor(Math.random() * 10);
            if (!ans.includes(randomNum)) {
                ans.push(randomNum);
            };
        };
    };

    // é—œé–‰æŒ‰éˆ•
    function disableBtn() {
        guessBtn.disabled = true;
        restartBtn.disabled = true;
        peekBtn.disabled = true;
    };

    // æ‰“é–‹æŒ‰éˆ•
    function ableBtn() {
        guessBtn.disabled = false;
        restartBtn.disabled = false;
        peekBtn.disabled = false;
    };
</script>

</html>